1.Introduction to Caret

Pre & Post-processing for Machine Learning 
========================================================
author:  Tue Vu - CITI-ACDS 
date:   Feb 2019  

4.1 Data partition: training and testing

4.2 Descriptive statistics

4.3 Preprocessing with missing value

4.4 Preprocessing: transform data

4.5 Visualize important variables

4.6 Feature selection

4.7 Train the model

4.8 Sample Machine Learning Algorithm

4.9 Predict the test set
4.10 Evaluate test result


4.1. Data partition: training & testing
========================================================

In Machine Learning, it is mandatory to have training and testing set. Some time a verification set is also recommended.

In usual practice, a typical sample size of training and testing set are 60% and 40%, respectively


```r
library(caret)
data(iris)
#create seed
set.seed(1234)
#Get row numbers for the training data based on dependent variable
ind <- createDataPartition(y=iris$Species,p=0.6,list=FALSE)
#list=FALSE, prevent returning result as a list
#Create the training set
training_iris <- iris[ind,]
#Create the testing set
testing_iris   <- iris[-ind,]
#Set the input (independent variables) for training set:
X <- training_iris[,1:4]
#Set the input (independent variables) for training set:
Y <- training_iris$Species
```

4.2. Descriptive statistics
========================================================

```r
dim(training)
names(training)
summary(training)
plot(training)
featurePlot(x=training,y=training$Species,
            plot="pairs")
```

First look at data
========================================================

```r
qq <- qplot(Petal.Width,Petal.Length,data=training,col=Species)
qq + geom_smooth(method="lm",formula=y~x)
```
Boxplot

```r
qplot(Species,Petal.Length,data=training,fill=Species,geom=c("boxplot","jitter"))
```


4.3 Preprocessing with missing value
========================================================
### omit NA

```r
library(base)
data("airquality")
new_airquality1 <- na.omit(airquality)
```

### set NA to mean value

```r
NA2mean <- function(x) replace(x, is.na(x), mean(x, na.rm = TRUE))
new_airquality2 <-replace(airquality, TRUE, lapply(airquality, NA2mean))
```

### Use Impute to handle missing value

```
Error in preProcess(airquality, method = "knnImpute") : 
  could not find function "preProcess"
```
